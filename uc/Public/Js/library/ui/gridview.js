BQ.add("ui.GridView",function(g){function d(k,a){var h=this,a=g.merge(n,a);if(!(h instanceof d))return new d(k,a);d.superclass.constructor.call(h,k,a);a.callback&&a.callback.beginning&&a.callback.beginning.call(h,h,a.DataSource.caption);var l=$(this.ele.Head,this.autoGrid);if(a.isMenu.menu)$(a.isMenu.id).get(0).oncontextmenu=function(){return!1},a.callback.rightMouse=function(b,e){var c=b.clientX,f=b.clientY,d=$(a.isMenu.id).width();document.body.clientWidth<c+d&&(c-=d);$(a.isMenu.id).css({position:"absolute",
left:c,top:f}).show();$(a.isMenu.id).mouseleave(function(){$(this).hide()});c={};f=$(e);c.item=f;c.field=f.attr("field");c.index=f.attr("class").match(/\d+$/)[0];h.lastCaption=c};var i=!1,j=!1,o=l.children(),e=null,p=function(){i=!0;e=$(this);$(window.document).bind({mouseup:m})},m=function(b){$(window.document).unbind("mouseup",m);if(b.button!=2){if(j)return i=j=!1;if(!i)return!1;if(a.callback&&a.callback.titleSort){var b=a.callback.titleSort,d=Object.prototype.toString.call(b)==="[object Array]",
c=d?b[1]:["grid_menu_zx","grid_menu_dx"],f=d?b[0]:"i",g=1;$(l).children().not(e).find(f).removeClass(c[0]).removeClass(c[1]);$(e).data("sort")==1?(g=2,$(e).data("sort",2),$(f,e).removeClass(c[0]).addClass(c[1])):(g=1,$(e).data("sort",1),$(f,e).removeClass(c[1]).addClass(c[0]));(d?b[2]:b).call(h,g,{index:e.attr("class").match(/r(\d+)$/)[1],field:e.attr("field")})}i=j=!1}};$.each(a.DataSource.caption,function(b){b=a.firstCheckbox?b+1:b;this.isSort&&$(o).eq(b).bind({mousedown:p})});$(window.document).mousemove(function(){i&&
(j=!0)})}var n={callback:{beginning:null},isMenu:{menu:!1,id:""}};g.augment(d,{lastCaption:{}});g.extend(d,g.ui.Grid);return d});
