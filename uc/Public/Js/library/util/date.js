BQ.add("util.Date",function(f){var e={};f.mix(e,{parseDate:function(b){if(b instanceof Date)return b;if(typeof b=="string"){var a=new Date(b);if(a.getTime())return a;if((a=b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) *$/))&&a.length>3)return new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3]));if((a=b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2}) *$/))&&a.length>6)return new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3]),parseInt(a[4]),parseInt(a[5]),parseInt(a[6]));if((a=
b.match(/^ *(\d{4})-(\d{1,2})-(\d{1,2}) +(\d{1,2}):(\d{1,2}):(\d{1,2})\.(\d{1,9}) *$/))&&a.length>7)return new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3]),parseInt(a[4]),parseInt(a[5]),parseInt(a[6]),parseInt(a[7]))}return null},format:function(b,a){b=this.parseDate(b);if(b==null)return null;if(b){var d={"M+":b.getMonth()+1,"d+":b.getDate(),"h+":b.getHours(),"m+":b.getMinutes(),"s+":b.getSeconds(),"q+":Math.floor((b.getMonth()+3)/3),S:b.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,
(b.getFullYear()+"").substr(4-RegExp.$1.length)))}for(var c in d)RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,RegExp.$1.length==1?d[c]:("00"+d[c]).substr((""+d[c]).length)));return a},diff:function(b,a){var d={},b=this.parseDate(b),a=this.parseDate(a);if(b==null||a==null)return null;var c=a-b;d.day=~~(c/864E5);d.hours=~~(c/36E5)%24;d.minutes=~~(c/6E4)%60;d.seconds=Math.floor(~~(c%6E4)/1E3)==60||Math.floor(~~(c%6E4)/1E3)==-60?0:Math.floor(~~(c%6E4)/1E3);return d},stringToDate:function(b){var a=
Date.parse(b),a=new Date(a);isNaN(a)&&(b=b.split("-"),a=new Date(b[0],b[1],b[2]));return a}});return e});
