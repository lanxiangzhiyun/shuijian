BQ.add("util.SubString",function(j){return{byteLen:function(c){for(var d=0,a=0,g=c.length,b;a<g;a++)b=c.charCodeAt(a),d+=b>127?2:1;return d},subStr:function(c,d,a,g){var b=0,f=0,e,h="",i=c.length;e=this.byteLen(c);d<0&&(d=e+d);for(a<0||!j.isNumber(a)?a=~~a+e:a+=d;b<i;b++){if(f>=d)break;e=c.charCodeAt(b);f+=e>127?2:1}for(;b<i;b++){e=c.charCodeAt(b);f+=e>127?2:1;if(f>a)break;h+=c.charAt(b)}return h+g}}});
