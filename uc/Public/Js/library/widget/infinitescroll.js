BQ.add("widget.InfiniteScroll",function(l){function h(b,a,i){if(!(this instanceof h))return new h(b,l.merge(m,a),i);var e=null,c={},b=$(b),f=b[0].scrollHeight,g=[0],d=0,c={Height:function(){a.height=a.height?a.height:b.css("height");return parseInt(parseInt(a.height)?a.height:b.outerHeight())},Li:function(){a.li=a.li_height?a.li_height:a.li;return parseInt(a.li?a.li:b.children().first().outerHeight())},Visible:function(){return parseInt(a.visible?a.visible:Math.ceil(a.height/a.li))},Unbind:function(){b.children().unbind("mouseenter,mouseleave")},
Max:function(){return parseInt(a.max?a.max:b.children().size())},Type:function(){return i?i:a.type},Timeout:function(){a.timeOut=a.timeOut-a.scroll<500?a.scroll+500:a.timeOut;a.timeOut=a.timeOut==3E3&&!a.type?30:a.timeOut;return a.timeOut},ScrollArray:function(){b.children().each(function(){g.push($(this).outerHeight())});return g}};c.Unbind();a.max=c.Max();a.height=c.Height();a.li=c.Li();a.type=c.Type();a.timeOut=c.Timeout();if(!(a.max<=c.Visible())){if(a.type==3||a.effect=="bottom")d=f,a.i=a.max;
a.type==2&&(g=c.ScrollArray());b.css({overflow:"hidden",height:a.height}).append(b.children().clone()).scrollTop(d);var j=function(){switch(a.type){case 1:case 3:a.type!=3&&a.effect=="top"?b.animate({scrollTop:++a.i*a.li},a.scroll,function(){a.i>=a.max&&(b.scrollTop(d),a.i=0)}):(a.type==3||a.effect=="bottom")&&b.animate({scrollTop:--a.i*a.li},a.scroll,function(){a.i<=0&&(b.scrollTop(d),a.i=a.max)});break;case 2:a.effect=="top"?b.animate({scrollTop:k(++a.i)},a.scroll,function(){a.i>=a.max&&(b.scrollTop(d),
a.i=0)}):a.effect=="bottom"&&b.animate({scrollTop:k(--a.i)},a.scroll,function(){a.i<=0&&(b.scrollTop(d),a.i=a.max)});break;default:var c=b[0].scrollTop;a.effect=="top"?(c>=f&&(c-=f),b.scrollTop(++c)):a.effect=="bottom"&&(c<=0&&(c+=f),b.scrollTop(--c))}},k=function(a){for(var b=0,c=0;c<=a;c++)b+=parseFloat(g[c]);return b};this.play=function(){j()};this.stop=function(){e&&clearInterval(e)};e=setInterval(function(){j()},a.timeOut);b.children().bind({mouseenter:function(){clearInterval(e)},mouseleave:function(){e=
setInterval(function(){j()},a.timeOut)}})}}var m={i:0,max:0,scroll:1E3,timeOut:3E3,height:0,li:0,li_height:0,visible:0,Deviation:0,effect:"top",type:0};return h});
