BQ.add("widget.LayerPosition",function(l){function h(n,a){function q(){function h(){if(a.iscss){a.parent!=null&&(_pt=$(a.parent));a.parent!=null&&(j={top:_pt.offset().top,left:_pt.offset().left,height:_pt.height(),width:_pt.width()});a.margin!=null&&(j={top:parseInt(a.margin[0]),left:parseInt(a.margin[1]),height:parseInt(a.margin[2]),width:parseInt(a.margin[3])});if(a.direction=="top"&&(b={top:d.top-m.height,left:d.left},a.parent!=null||a.margin!=null))b={top:b.top<j.top?d.top+d.height:b.top,left:b.left};
if(a.direction=="bottom"&&(b={top:d.top+d.height,left:d.left},a.parent!=null||a.margin!=null))b={top:b.top>j.height-d.height?d.top-m.height:b.top,left:b.left};if(a.direction=="left"&&(b={top:d.top,left:d.left-m.width},a.parent!=null||a.margin!=null))b={top:b.top,left:b.left<j.left?d.left+d.width:b.left};if(a.direction=="right"&&(b={top:d.top,left:d.left+d.width},a.parent!=null||a.margin!=null))b={top:b.top,left:b.left-d.width>j.width-d.width?d.left-m.width:b.left};f.css({top:b.top-l,left:b.left-k,
zIndex:99999})}a.CustStyle!=null&&f.css(a.CustStyle)}var i=$(n),f=$(a.layer),j,b,g,d,m,e=document.all,k=0,l=0,o,r=function(c){a.layermiddle&&q(c);a.drag&&BQ.ui.Drag(c);a.callback!=null&&a.callback(c);var b=g;b.css({position:e?"absolute":"fixed",left:0,top:0,opacity:0,backgroundColor:a.backcolor,width:Math.max(document.documentElement.clientWidth,document.documentElement.scrollWidth),height:Math.max(document.documentElement.clientHeight,document.documentElement.scrollHeight,document.body.scrollHeight)});
b.eq(0).css("opacity",a.opacity);a.isFrame&&g.show();c.show()},p=function(c){a.closType==0&&c.mouseleave(function(a){a.preventDefault();g.hide();$(this).hide()});a.closed!=null&&$(a.closed).click(function(a){a.preventDefault();g.hide();c.hide()})},t=function(c){if(a.direction=="bottom")a.direction="left_bottom";a.direction!=null&&(a.direction=="left_top"&&c.css({position:e?"absolute":"fixed",left:0,top:e?$(window).scrollTop():0}),a.direction=="left_center"&&c.css({position:e?"absolute":"fixed",left:0,
top:($(window).height()-c.height())/2+(e?$(window).scrollTop():0)}),a.direction=="left_bottom"&&c.css({position:e?"absolute":"fixed",left:0,top:$(window).height()-c.height()+(e?$(window).scrollTop():0)}),a.direction=="right_top"&&c.css({position:e?"absolute":"fixed",left:$(window).width()-c.width(),top:e?$(window).scrollTop():0}),a.direction=="right_center"&&c.css({position:e?"absolute":"fixed",left:$(window).width()-c.width(),top:($(window).height()-c.height())/2+(e?$(window).scrollTop():0)}),a.direction==
"right_bottom"&&c.css({position:e?"absolute":"fixed",left:$(window).width()-c.width(),top:$(window).height()-c.height()+(e?$(window).scrollTop():0)}));a.callback!=null&&a.callback(c,$(window).height(),$(window).scrollTop())},q=function(a){wt=($(window).width()-$(a).width())/2+(e?$(window).scrollLeft():0);ht=($(window).height()-$(a).height())/2+(e?$(window).scrollTop():0);$(a).css({position:e?"absolute":"fixed",top:ht,left:wt});$(a).show();$(window).scroll(function(){$(a).css({position:e?"absolute":
"fixed",top:($(window).height()-$(a).height())/2+(e?$(window).scrollTop():0),left:$(a).css("left")})})},u=function(c){c.bind({mouseenter:function(a){a.preventDefault();h();r(f)},mouseleave:function(c){$(c.relatedTarget).parents(a.layer).length==0?(f.hide(),g.hide()):p(f)}})},s=function(a,b){b?o=f:a.bind({mousedown:function(a){a.preventDefault();h();r(f);p(f)}})},v=function(a){t(a);$(window).scroll(function(){t(a)});p(a)};this.Initialize=function(){f.parents().each(function(){$(this).css("position")&&
$(this).css("position")=="relative"&&(k+=$(this).offset().left,l+=$(this).offset().top)});document.all?($(".layerPosition_floatObject").length||(g=$("<div class='layerPosition_floatObject' style='position:absolute;left:0;top:0;border:0;z-index:9999;display:none;' frameborder='no'></div><iframe class='layerPosition_floatObject' style='display:none;width:100%;height:100%;' frameborder='no'></iframe><div class='layerPosition_floatObject' style='position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;display:none;'></div>").prependTo($("body"))),
g=$(".layerPosition_floatObject")):g=$("#layerPosition_floatObject").length?$("#layerPosition_floatObject"):$("<div id='layerPosition_floatObject' style='position:absolute;left:0;top:0;border:0;z-index:9999;display:none;' frameborder='no'></div>").prependTo($("body"));if(a.isOverflowButtom)v(f);else try{switch(n.length&&(d={top:i.offset().top||0,left:i.offset().left||0,width:i.width()||0,height:i.height()||0}),m={width:f.width()||0,height:f.height()||0},a.eventType){case 0:i.each(function(){u($(this))});
break;case 1:i.each(function(){s($(this),a.show)});break;default:i.each(function(){u($(this))})}}catch(b){return!1}};this.show=function(){h();r(o);p(o)};this.close=function(){g.hide();$(o).hide()}}if(!(this instanceof h))return new h(n,l.merge(s,a));a=this.config=a;if(n.length||a.isOverflowButtom){var k=new q;k.Initialize();this.show=k.show;this.close=k.close}}var s={layer:null,eventType:0,closType:0,direction:"bottom",center:!1,callback:null,closed:null,isMove:!1,iscss:!0,isFull:!1,isOverflowButtom:!1,
isActive:!0,CustStyle:null,parent:null,margin:null,backcolor:"",opacity:0.5,isFrame:!1,layopacity:0.5,drag:!1,prevent:!0,layermiddle:!1,show:!1};l.augment(h,{close:function(){this.close()},shows:function(){this.show()}});return h});
