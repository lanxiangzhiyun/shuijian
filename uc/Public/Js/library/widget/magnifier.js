BQ.add("widget.Magnifier",function(k){function i(h,j,b){function l(){a.Box.css("display","block");var c={clientWidth:a.Box[0].clientWidth,clientHeight:a.Box[0].clientHeight,mulWidth:a.boxImg.width()/a.winImg.width(),mulHeight:a.boxImg.height()/a.winImg.height()};a.Box.css("display","none");return c}var a=this;if(!(a instanceof i))return new i(h,j,k.merge(defaultConfig,b));a.config=b;a.Win=$(h).eq(0);a.Box=$(j).eq(0);a.winImg=$("img:eq(0)",a.Win);a.boxImg=$("img:eq(0)",a.Box);if(a.Win.length&&a.Box.length){a.leaveBox=
function(){a.Box.hide();a.divZoom.hide()};if(b.type==2){var h=l(),f=~~(h.clientWidth/b.multiple),g=~~(h.clientHeight/b.multiple);a.divZoom=a.Win.children().hasClass(b.divZoom)?a.Win.children("."+b.divZoom):$("<div class='"+b.divZoom+"'></div>").appendTo(a.Win);a.divZoom.css({width:f,height:g,display:"none",position:"absolute",opacity:0.5,"background-color":b.backStyle});a.boxImg.width(a.winImg.width()*(a.Box.width()/parseInt(a.divZoom.css("width"))));a.boxImg.height(a.winImg.height()*(a.Box.height()/
parseInt(a.divZoom.css("height"))))}a.Win.bind({mouseenter:function(){a.Box.show();a.divZoom.show();f=Math.max(f,a.divZoom[0].offsetWidth);g=Math.max(g,a.divZoom[0].offsetHeight)},mousemove:function(c){c.stopPropagation();var e=a.config.type,d=a.Win.offset(),b=c.pageX-d.left,c=c.pageY-d.top;if(e==2&&(e=b,d=c,a.divZoom)){e-=f/2;d-=g/2;var h=a.winImg.width(),i=a.winImg.height();e<0?e=0:e+f>h&&(e=h-f);d<0?d=0:d+g>i&&(d=i-g);a.divZoom.css({left:e+"px",top:d+"px",display:"block"})}a.divZoom&&(b-=f/2,c-=
g/2,e=a.winImg.width(),d=a.winImg.height(),b<0?b=0:b+f>e&&(b=e-f),c<0?c=0:c+g>d&&(c=d-g),a.boxImg.css({left:-b*3+"px",top:-c*3+"px",display:"block"}))},mouseleave:function(){a.leaveBox()}});a.Box.mouseenter(function(){a.Box.hide();a.divZoom.hide()});a.Box.css({position:"absolute",overflow:"hidden","z-index":"900"});a.boxImg.css({position:"relative"});a.Win.css({position:"absolute",cursor:"move"})}}defaultConfig={type:2,multiple:3,divZoom:"divcur",bigPos:null,backStyle:"#ddd"};return i});
